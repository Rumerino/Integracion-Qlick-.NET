@model eSmash.Models.View.QlikApplication
@{
    var routeValues = @HttpContext.Current.Request.RequestContext.RouteData.Values;

    var themeName = routeValues.ContainsKey("theme")
        ? routeValues["theme"].ToString().ToLower()
        : "default";
        
    var addCssTheme = themeName != "default";            
}
<!DOCTYPE html>
<html>
<head>



    @Html.Partial("~/Views/Shared/_Head.cshtml")
    @*model.Application.*@
    <!-- Qlik Sense mashup specific -->
    @*@Styles.Render("~/Content/qlik")*@
    <link rel="stylesheet" href="https://@Model.DomainName/@Model.vProxy/resources/autogenerated/qlik-styles.css">
    

    <!-- Styles -->
    @Styles.Render("~/Content/css/demo")
    
    @RenderSection("styles", required: false)
    
    <link rel="stylesheet" href="https://@Model.DomainName/@Model.vProxy/resources/autogenerated/qlikui.css">
    @*<link rel="stylesheet" href="https:xwdqlik121/dev/resources/autogenerated/qlik-styles.css">*@
    @*@Styles.Render("https:xwdqlik121/resources/autogenerated/qlikui.css")*@
    @if (addCssTheme)
    {
        @*@Styles.Render("~/Content/css/theme" + themeName)*@
        @*@Styles.Render("~/Content/css/theme2")*@
    }

    <title>@ViewBag.Title</title>
</head>
<body>
    
    <!-- Modal section: should go before "canvas-container" to display correctly -->
    @Html.Partial("~/Views/Shared/ErrorModal.cshtml")
    @*@Html.Action("Glossary")*@
    @RenderSection("modal", required: false)

    <!-- Offcanvas filter panel -->
    @Html.Partial("~/Views/Shared/FilterPanelOffcanvas.cshtml")

    <!-- Offcanvas content container -->
    <div id="canvas-static">

        <!-- Navbar -->
        @Html.Action("NavBarTop2","eSmash")

        <div id="intro-header">
            <div class="container-fluid">
                @RenderSection("intro_header", required: false)
            </div>
        </div>

        <div id="bodyQlikRender" class="container-fluid body-content" data-qlik-app="@Model.App.Id">
            @RenderBody()
        </div>

        <!-- Sticky footer for small devices -->
        <div class="hidden-lg hidden-md visible-xs-block visible-sm-block">
            @Html.Action("NavBarBottom")
        </div>

        @Html.Partial("~/Views/Shared/_Footer.cshtml")

    </div>

    <!-- Scripts -->
    @* IMPORTANT: list.js gives an error if it is loaded after Qlik's require.js *@
    @Scripts.Render("~/bundles/list.js")

    <!-- Qlik require.js Desktop version -->
    @*@Scripts.Render("~/bundles/qlik/require.js")*@
    @*@section qlikstyles {
        <link rel="stylesheet" href="@(Model.url)resources/autogenerated/qlikui.css">
        <link rel="stylesheet" href="@(Model.url)resources/assets/client/client.css" media="all">
        <link href="~/Content/mashup.css" rel="stylesheet" />
    }
    likscripts {

    <script src="@(Model.url)resources/assets/external/requirejs/require.js"></script>
    <script src="@(Model.url)resources/js/qlik.js"></script>
    <script src="~/Scripts/mashup.js"></script>
    }*@
    <script src="https://@Model.DomainName/@Model.vProxy/resources/assets/external/requirejs/require.js"></script>
    @Html.Partial("~/Views/Shared/_JavaScript.cshtml")
   
    <script>
        var qlikServerConfig = {
            host: "@Model.DomainName",
            prefix: "/@Model.vProxy/",
            port: "443",
            //isSecure: window.location.protocol === "https:"
            isSecure: true
            //http://localhost:4848/resources/js/qlik.js
        };

    </script>

    @Scripts.Render("~/bundles/qlik")
    @Scripts.Render("~/bundles/demo")
    @*@Scripts.Render("~/bundles/jquery")*@
    
    
    @RenderSection("scripts", required: false)

    <!-- Current selection template -->
    @Html.Partial("~/Views/Shared/CurrentSelectionOffcanvasTemplate.cshtml")

</body>
</html>
